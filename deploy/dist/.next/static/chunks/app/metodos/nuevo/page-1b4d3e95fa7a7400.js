(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9122],{924:(e,t,r)=>{"use strict";r.d(t,{c4:()=>n,e9:()=>s,nC:()=>c});var o=r(9509);let a=()=>"https://cidson.api.production.com",s=()=>a().replace(/\/$/,"");function n(){{let e=localStorage.getItem("auth_token");if(e)return e;let t=sessionStorage.getItem("auth_token");if(t)return t}return null}let c={BASE_URL:o.env.NEXT_PUBLIC_API_URL||"https://cidson.int.qaenv.dev",ENDPOINTS:{LOGIN:"/api/login",EMPRESAS:"/api/empresas",ACTIVIDADES:"/api/actividades",ZONAS:"/api/zonas",AREAS:"/api/areas",METODOS:"/api/metodos",MATERIALES:"/api/materiales",MOTIVOS:"/api/motivos",CHECKLISTS:"/api/checklists"}}},4229:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(9946).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},4649:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var o=r(5155),a=r(2115),s=r(5695),n=r(7550),c=r(4229),i=r(6874),l=r.n(i),d=r(4811);function u(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)().get("empresaId"),[r,i]=(0,a.useState)({nombre:"",descripcion:""}),[u,m]=(0,a.useState)({nombre:"",descripcion:""}),[h,p]=(0,a.useState)(!1),g=e=>{let{name:t,value:o}=e.target;i({...r,[t]:o}),u[t]&&m({...u,[t]:""})},f=()=>{let e=!0,t={nombre:"",descripcion:""};return r.nombre.trim()||(t.nombre="El nombre del metodo ya existe. Por favor, utilice otro nombre.",e=!1),r.descripcion.trim()||(t.descripcion="La descripci\xf3n del m\xe9todo es requerida",e=!1),m(t),e},E=async o=>{if(o.preventDefault(),f()&&t)try{p(!0),await d.W.create(Number(t),{nombre:r.nombre.trim(),descripcion:r.descripcion.trim()}),e.push("/metodos?empresaId=".concat(t))}catch(e){console.error("Error al crear el m\xe9todo:",e),m({...u,nombre:"El nombre del metodo ya existe. Por favor, utilice otro nombre."})}finally{p(!1)}};return(0,o.jsx)("div",{className:"bg-[#f4f6fb] min-h-screen",children:(0,o.jsxs)("div",{className:"pl-8 pr-6 py-6 max-w-[1200px]",children:[(0,o.jsxs)(l(),{href:"/metodos".concat(t?"?empresaId=".concat(t):""),className:"inline-flex items-center text-[#303e65] mb-6",children:[(0,o.jsx)(n.A,{className:"h-4 w-4 mr-2"}),"Regresar"]}),(0,o.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Nuevo registro"}),(0,o.jsx)("p",{className:"text-gray-600 mb-8",children:"Crea y registra un nuevo m\xe9todo."}),(0,o.jsx)("div",{className:"bg-white rounded-xl p-8 shadow-sm max-w-[800px] mx-auto",children:(0,o.jsxs)("form",{onSubmit:E,children:[(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("input",{type:"text",id:"nombre",name:"nombre",placeholder:"Nombre Del M\xe9todo",value:r.nombre,onChange:g,className:"w-full h-12 px-4 bg-[#f4f6fb] rounded-md border-0 focus:ring-2 focus:ring-[#303e65] ".concat(u.nombre?"ring-2 ring-red-500":"")}),u.nombre&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-500",children:u.nombre})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("textarea",{id:"descripcion",name:"descripcion",placeholder:"Descripci\xf3n Del M\xe9todo",value:r.descripcion,onChange:g,rows:4,className:"w-full px-4 py-3 bg-[#f4f6fb] rounded-md border-0 focus:ring-2 focus:ring-[#303e65] ".concat(u.descripcion?"ring-2 ring-red-500":"")}),u.descripcion&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-500",children:u.descripcion})]})]}),(0,o.jsx)("div",{className:"flex justify-end mt-8",children:(0,o.jsx)("button",{type:"submit",disabled:h,className:"flex items-center justify-center bg-[#f5d433] text-[#303e65] font-medium px-6 py-2.5 rounded-full hover:bg-[#f0ca20] transition-colors disabled:opacity-70",children:h?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"w-4 h-4 border-2 border-[#303e65] border-t-transparent rounded-full animate-spin mr-2"}),"Guardando..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.A,{className:"h-5 w-5 mr-2"}),"Guardar"]})})})]})})]})})}},4811:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});var o=r(5305);class a{static async getAll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;try{if(!e)return{data:[],links:{first:"",last:"",prev:null,next:null},meta:{current_page:1,from:0,last_page:1,links:[],path:"",per_page:10,to:0,total:0}};let s="/api/metodos/".concat(e,"?page=").concat(t);r&&(s+="&nombre=".concat(encodeURIComponent(r))),void 0!==a&&(s+="&estado=".concat(a)),console.log("Obteniendo m\xe9todos: ".concat(s));let n=await o.Q.get(s);return n.data||(console.warn("La respuesta no contiene datos",n),n.data=[]),n}catch(e){throw console.error("Error al obtener m\xe9todos:",e),e}}static async getById(e){try{return(await o.Q.get("/api/metodos/".concat(e))).data}catch(t){console.error("Error al obtener m\xe9todo con id ".concat(e,":"),t);return}}static async create(e,t){try{return console.log("Creando m\xe9todo para empresa ".concat(e,":"),t),(await o.Q.post("/api/metodos/store/".concat(e),t)).data}catch(e){throw console.error("Error al crear m\xe9todo:",e),e}}static async update(e,t){try{return(await o.Q.put("/api/metodos/update/".concat(e),{nombre:t.nombre,descripcion:t.descripcion})).data}catch(t){var r,a;if(console.error("Error al actualizar m\xe9todo con id ".concat(e,":"),t),null===(a=t.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)throw Error(t.response.data.message);throw t}}static async toggleEstado(e){try{console.log("Cambiando estado del m\xe9todo con id ".concat(e));let t=await o.Q.delete("/api/metodos/destroy/".concat(e));return console.log("Respuesta de toggleEstado:",t),t.data}catch(t){throw console.error("Error al cambiar estado del m\xe9todo con id ".concat(e,":"),t),t}}static async delete(e){try{return await o.Q.delete("/api/metodo/".concat(e)),!0}catch(t){return console.error("Error al eliminar m\xe9todo con id ".concat(e,":"),t),!1}}}},5305:(e,t,r)=>{"use strict";r.d(t,{Q:()=>s});var o=r(924),a=r(9509);class s{static getHeaders(){let e={"Content-Type":"application/json",Accept:"application/json"},t=(0,o.c4)();return t&&(e.Authorization="Bearer ".concat(t)),console.log("Headers de la petici\xf3n:",e),e}static async handleResponse(e){let t;if(!e.ok){let t;let r=e.headers.get("content-type")||"";try{t=await e.text()}catch(t){throw Error("Error HTTP: ".concat(e.status,", ").concat(e.statusText))}if(r.includes("text/html"))throw console.error("Respuesta HTML recibida:",t.substring(0,200)+"..."),Error("El servidor devolvi\xf3 HTML en lugar de JSON. C\xf3digo: ".concat(e.status));try{let r=JSON.parse(t),o=r.message||r.error||"Error HTTP: ".concat(e.status);throw Error(o)}catch(r){throw Error("Error HTTP: ".concat(e.status,", ").concat(t||e.statusText))}}if("0"===e.headers.get("content-length"))return{};let r=e.headers.get("content-type")||"";try{t=await e.text()}catch(e){throw Error("Error al leer la respuesta del servidor")}if(!r.includes("application/json")){if(console.warn("Respuesta no es JSON: ".concat(r)),t.trim().startsWith("<!DOCTYPE")||t.trim().startsWith("<html"))throw console.error("Respuesta HTML recibida:",t.substring(0,200)+"..."),Error("El servidor devolvi\xf3 HTML en lugar de JSON");try{return JSON.parse(t)}catch(e){throw console.error("No se pudo parsear la respuesta como JSON:",t.substring(0,200)+"..."),Error("Respuesta no v\xe1lida: no es JSON")}}try{return JSON.parse(t)}catch(e){throw console.error("Error al parsear JSON:",e),console.error("Contenido de la respuesta:",t.substring(0,200)+"..."),Error("Error al parsear la respuesta JSON")}}static async get(e){try{let t=this.ensureAbsoluteUrl(e);console.log("GET Request URL:",t);let r=this.getHeaders();console.log("GET Request Headers:",r);let o=await fetch(t,{method:"GET",headers:r});return await this.handleResponse(o)}catch(e){throw console.error("GET Request Error:",e),e}}static async post(e,t){try{let r=this.ensureAbsoluteUrl(e);console.log("POST:",r),console.log("Datos:",t);let o=await fetch(r,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(t)});return await this.handleResponse(o)}catch(t){throw console.error("Error en solicitud POST a ".concat(e,":"),t),t}}static async put(e,t){try{let r=this.ensureAbsoluteUrl(e);console.log("PUT:",r),console.log("Datos:",t);let o=await fetch(r,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(t)});return await this.handleResponse(o)}catch(t){throw console.error("Error en solicitud PUT a ".concat(e,":"),t),t}}static async delete(e){try{let t=this.ensureAbsoluteUrl(e);console.log("DELETE:",t);let r=await fetch(t,{method:"DELETE",headers:this.getHeaders()});return await this.handleResponse(r)}catch(t){throw console.error("Error en solicitud DELETE a ".concat(e,":"),t),t}}static ensureAbsoluteUrl(e){try{return new URL(e),e}catch(o){let t=(a.env.NEXT_PUBLIC_API_URL||"https://cidson.int.qaenv.dev").replace(/\/+$/,""),r=e.replace(/^\/+/,"");return"".concat(t,"/").concat(r)}}static async handleError(e){try{let t=await e.json();if(t.message)return Error(t.message);return Error("Error HTTP: ".concat(e.status))}catch(t){return Error("Error HTTP: ".concat(e.status))}}}},5340:(e,t,r)=>{Promise.resolve().then(r.bind(r,4649))},5695:(e,t,r)=>{"use strict";var o=r(8999);r.o(o,"useParams")&&r.d(t,{useParams:function(){return o.useParams}}),r.o(o,"usePathname")&&r.d(t,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}}),r.o(o,"useSearchParams")&&r.d(t,{useSearchParams:function(){return o.useSearchParams}})},7550:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9946:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var o=r(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,o.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:l="",children:d,iconNode:u,...m}=e;return(0,o.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:r,strokeWidth:i?24*Number(c)/Number(a):c,className:s("lucide",l),...m},[...u.map(e=>{let[t,r]=e;return(0,o.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,o.forwardRef)((r,n)=>{let{className:i,...l}=r;return(0,o.createElement)(c,{ref:n,iconNode:t,className:s("lucide-".concat(a(e)),i),...l})});return r.displayName="".concat(e),r}}},e=>{var t=t=>e(e.s=t);e.O(0,[6874,8441,1684,7358],()=>t(5340)),_N_E=e.O()}]);