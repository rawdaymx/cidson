(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2858],{924:(e,r,t)=>{"use strict";t.d(r,{c4:()=>n,e9:()=>s,nC:()=>c});var a=t(9509);let o=()=>"https://cidson.api.production.com",s=()=>o().replace(/\/$/,"");function n(){{let e=localStorage.getItem("auth_token");if(e)return e;let r=sessionStorage.getItem("auth_token");if(r)return r}return null}let c={BASE_URL:a.env.NEXT_PUBLIC_API_URL||"https://cidson.int.qaenv.dev",ENDPOINTS:{LOGIN:"/api/login",EMPRESAS:"/api/empresas",ACTIVIDADES:"/api/actividades",ZONAS:"/api/zonas",AREAS:"/api/areas",METODOS:"/api/metodos",MATERIALES:"/api/materiales",MOTIVOS:"/api/motivos",CHECKLISTS:"/api/checklists"}}},1749:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var a=t(5155),o=t(2115),s=t(5695),n=t(7550),c=t(4229),i=t(6874),l=t.n(i),d=t(4811);function u(){let e=(0,s.useRouter)(),r=(0,s.useParams)(),t=(0,s.useSearchParams)(),i=Number(r.id),u=t.get("empresaId"),m=t.get("data"),[h,p]=(0,o.useState)({nombre:"",descripcion:""}),[g,f]=(0,o.useState)({nombre:"",descripcion:""}),[b,E]=(0,o.useState)(!0),[y,v]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if(m)try{let e=JSON.parse(decodeURIComponent(m));p({nombre:e.nombre||"",descripcion:e.descripcion||""}),E(!1);return}catch(e){console.error("Error al parsear los datos del m\xe9todo:",e)}let r=async()=>{try{E(!0);let r=await d.W.getById(i);r?p({nombre:r.nombre,descripcion:r.descripcion}):e.push("/metodos".concat(u?"?empresaId=".concat(u):""))}catch(r){console.error("Error al cargar el m\xe9todo:",r),e.push("/metodos".concat(u?"?empresaId=".concat(u):""))}finally{E(!1)}};i&&!m&&r()},[i,m,u,e]);let x=e=>{let{name:r,value:t}=e.target;p({...h,[r]:t}),g[r]&&f({...g,[r]:""})},w=()=>{let e=!0,r={nombre:"",descripcion:""};return h.nombre.trim()||(r.nombre="El nombre del m\xe9todo es requerido",e=!1),h.descripcion.trim()||(r.descripcion="La descripci\xf3n del m\xe9todo es requerida",e=!1),f(r),e},N=async r=>{if(r.preventDefault(),w())try{v(!0),await d.W.update(i,{nombre:h.nombre.trim(),descripcion:h.descripcion.trim()}),e.push("/metodos".concat(u?"?empresaId=".concat(u):""))}catch(e){var t;console.error("Error al actualizar el m\xe9todo:",e),(null==e?void 0:null===(t=e.message)||void 0===t?void 0:t.includes("The nombre has already been taken"))?f({...g,nombre:"El nombre del m\xe9todo ya existe. Por favor, utilice otro nombre."}):f({...g,descripcion:"Ocurri\xf3 un error al actualizar el m\xe9todo. Por favor, intente nuevamente."})}finally{v(!1)}};return b?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-[#f4f6fb]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-[#303e65] border-t-[#f5d433] rounded-full animate-spin mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Cargando informaci\xf3n..."})]})}):(0,a.jsx)("div",{className:"bg-[#f4f6fb] min-h-screen",children:(0,a.jsxs)("div",{className:"pl-8 pr-6 py-6 max-w-[1200px]",children:[(0,a.jsxs)(l(),{href:"/metodos".concat(u?"?empresaId=".concat(u):""),className:"inline-flex items-center text-[#303e65] mb-6",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-2"}),"Regresar"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Editar registro"}),(0,a.jsx)("p",{className:"text-gray-600 mb-8",children:"Edita el m\xe9todo seleccionado."}),(0,a.jsx)("div",{className:"bg-white rounded-xl p-8 shadow-sm max-w-[800px] mx-auto",children:(0,a.jsxs)("form",{onSubmit:N,children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"text",id:"nombre",name:"nombre",placeholder:"Nombre Del M\xe9todo",value:h.nombre,onChange:x,className:"w-full h-12 px-4 bg-[#f4f6fb] rounded-md border-0 focus:ring-2 focus:ring-[#303e65] ".concat(g.nombre?"ring-2 ring-red-500":"")}),g.nombre&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.nombre})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"text",id:"descripcion",name:"descripcion",placeholder:"Descripci\xf3n Del M\xe9todo",value:h.descripcion,onChange:x,className:"w-full h-12 px-4 bg-[#f4f6fb] rounded-md border-0 focus:ring-2 focus:ring-[#303e65] ".concat(g.descripcion?"ring-2 ring-red-500":"")}),g.descripcion&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:g.descripcion})]})]}),(0,a.jsx)("div",{className:"flex justify-end mt-8",children:(0,a.jsx)("button",{type:"submit",disabled:y,className:"flex items-center justify-center bg-[#f5d433] text-[#303e65] font-medium px-6 py-2.5 rounded-full hover:bg-[#f0ca20] transition-colors disabled:opacity-70",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-[#303e65] border-t-transparent rounded-full animate-spin mr-2"}),"Guardando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{className:"h-5 w-5 mr-2"}),"Guardar"]})})})]})})]})})}},4229:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(9946).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},4811:(e,r,t)=>{"use strict";t.d(r,{W:()=>o});var a=t(5305);class o{static async getAll(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;try{if(!e)return{data:[],links:{first:"",last:"",prev:null,next:null},meta:{current_page:1,from:0,last_page:1,links:[],path:"",per_page:10,to:0,total:0}};let s="/api/metodos/".concat(e,"?page=").concat(r);t&&(s+="&nombre=".concat(encodeURIComponent(t))),void 0!==o&&(s+="&estado=".concat(o)),console.log("Obteniendo m\xe9todos: ".concat(s));let n=await a.Q.get(s);return n.data||(console.warn("La respuesta no contiene datos",n),n.data=[]),n}catch(e){throw console.error("Error al obtener m\xe9todos:",e),e}}static async getById(e){try{return(await a.Q.get("/api/metodos/".concat(e))).data}catch(r){console.error("Error al obtener m\xe9todo con id ".concat(e,":"),r);return}}static async create(e,r){try{return console.log("Creando m\xe9todo para empresa ".concat(e,":"),r),(await a.Q.post("/api/metodos/store/".concat(e),r)).data}catch(e){throw console.error("Error al crear m\xe9todo:",e),e}}static async update(e,r){try{return(await a.Q.put("/api/metodos/update/".concat(e),{nombre:r.nombre,descripcion:r.descripcion})).data}catch(r){var t,o;if(console.error("Error al actualizar m\xe9todo con id ".concat(e,":"),r),null===(o=r.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)throw Error(r.response.data.message);throw r}}static async toggleEstado(e){try{console.log("Cambiando estado del m\xe9todo con id ".concat(e));let r=await a.Q.delete("/api/metodos/destroy/".concat(e));return console.log("Respuesta de toggleEstado:",r),r.data}catch(r){throw console.error("Error al cambiar estado del m\xe9todo con id ".concat(e,":"),r),r}}static async delete(e){try{return await a.Q.delete("/api/metodo/".concat(e)),!0}catch(r){return console.error("Error al eliminar m\xe9todo con id ".concat(e,":"),r),!1}}}},5305:(e,r,t)=>{"use strict";t.d(r,{Q:()=>s});var a=t(924),o=t(9509);class s{static getHeaders(){let e={"Content-Type":"application/json",Accept:"application/json"},r=(0,a.c4)();return r&&(e.Authorization="Bearer ".concat(r)),console.log("Headers de la petici\xf3n:",e),e}static async handleResponse(e){let r;if(!e.ok){let r;let t=e.headers.get("content-type")||"";try{r=await e.text()}catch(r){throw Error("Error HTTP: ".concat(e.status,", ").concat(e.statusText))}if(t.includes("text/html"))throw console.error("Respuesta HTML recibida:",r.substring(0,200)+"..."),Error("El servidor devolvi\xf3 HTML en lugar de JSON. C\xf3digo: ".concat(e.status));try{let t=JSON.parse(r),a=t.message||t.error||"Error HTTP: ".concat(e.status);throw Error(a)}catch(t){throw Error("Error HTTP: ".concat(e.status,", ").concat(r||e.statusText))}}if("0"===e.headers.get("content-length"))return{};let t=e.headers.get("content-type")||"";try{r=await e.text()}catch(e){throw Error("Error al leer la respuesta del servidor")}if(!t.includes("application/json")){if(console.warn("Respuesta no es JSON: ".concat(t)),r.trim().startsWith("<!DOCTYPE")||r.trim().startsWith("<html"))throw console.error("Respuesta HTML recibida:",r.substring(0,200)+"..."),Error("El servidor devolvi\xf3 HTML en lugar de JSON");try{return JSON.parse(r)}catch(e){throw console.error("No se pudo parsear la respuesta como JSON:",r.substring(0,200)+"..."),Error("Respuesta no v\xe1lida: no es JSON")}}try{return JSON.parse(r)}catch(e){throw console.error("Error al parsear JSON:",e),console.error("Contenido de la respuesta:",r.substring(0,200)+"..."),Error("Error al parsear la respuesta JSON")}}static async get(e){try{let r=this.ensureAbsoluteUrl(e);console.log("GET Request URL:",r);let t=this.getHeaders();console.log("GET Request Headers:",t);let a=await fetch(r,{method:"GET",headers:t});return await this.handleResponse(a)}catch(e){throw console.error("GET Request Error:",e),e}}static async post(e,r){try{let t=this.ensureAbsoluteUrl(e);console.log("POST:",t),console.log("Datos:",r);let a=await fetch(t,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(r)});return await this.handleResponse(a)}catch(r){throw console.error("Error en solicitud POST a ".concat(e,":"),r),r}}static async put(e,r){try{let t=this.ensureAbsoluteUrl(e);console.log("PUT:",t),console.log("Datos:",r);let a=await fetch(t,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(r)});return await this.handleResponse(a)}catch(r){throw console.error("Error en solicitud PUT a ".concat(e,":"),r),r}}static async delete(e){try{let r=this.ensureAbsoluteUrl(e);console.log("DELETE:",r);let t=await fetch(r,{method:"DELETE",headers:this.getHeaders()});return await this.handleResponse(t)}catch(r){throw console.error("Error en solicitud DELETE a ".concat(e,":"),r),r}}static ensureAbsoluteUrl(e){try{return new URL(e),e}catch(a){let r=(o.env.NEXT_PUBLIC_API_URL||"https://cidson.int.qaenv.dev").replace(/\/+$/,""),t=e.replace(/^\/+/,"");return"".concat(r,"/").concat(t)}}static async handleError(e){try{let r=await e.json();if(r.message)return Error(r.message);return Error("Error HTTP: ".concat(e.status))}catch(r){return Error("Error HTTP: ".concat(e.status))}}}},5695:(e,r,t)=>{"use strict";var a=t(8999);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},7550:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8496:(e,r,t)=>{Promise.resolve().then(t.bind(t,1749))},9946:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var a=t(2115);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:l="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:r,...n,width:o,height:o,stroke:t,strokeWidth:i?24*Number(c)/Number(o):c,className:s("lucide",l),...m},[...u.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(d)?d:[d]])}),i=(e,r)=>{let t=(0,a.forwardRef)((t,n)=>{let{className:i,...l}=t;return(0,a.createElement)(c,{ref:n,iconNode:r,className:s("lucide-".concat(o(e)),i),...l})});return t.displayName="".concat(e),t}}},e=>{var r=r=>e(e.s=r);e.O(0,[6874,8441,1684,7358],()=>r(8496)),_N_E=e.O()}]);