(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4978],{924:(e,a,r)=>{"use strict";r.d(a,{c4:()=>s,e9:()=>n,nC:()=>i});var t=r(9509);let o=()=>"https://cidson.api.production.com",n=()=>o().replace(/\/$/,"");function s(){{let e=localStorage.getItem("auth_token");if(e)return e;let a=sessionStorage.getItem("auth_token");if(a)return a}return null}let i={BASE_URL:t.env.NEXT_PUBLIC_API_URL||"https://cidson.int.qaenv.dev",ENDPOINTS:{LOGIN:"/api/login",EMPRESAS:"/api/empresas",ACTIVIDADES:"/api/actividades",ZONAS:"/api/zonas",AREAS:"/api/areas",METODOS:"/api/metodos",MATERIALES:"/api/materiales",MOTIVOS:"/api/motivos",CHECKLISTS:"/api/checklists"}}},1096:(e,a,r)=>{Promise.resolve().then(r.bind(r,5235))},1276:(e,a,r)=>{"use strict";r.d(a,{V:()=>o});var t=r(924);class o{static async getAll(e,a){try{let r=(0,t.e9)(),o=(0,t.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad";if(!r)throw console.error("URL de API no definida"),Error("URL de API no definida");let n="".concat(r,"/api/materiales/").concat(e);if(a){let e=new URLSearchParams;a.nombre&&e.append("nombre",a.nombre),void 0!==a.estado&&e.append("estado",a.estado.toString()),a.page&&e.append("page",a.page.toString());let r=e.toString();r&&(n+="?".concat(r))}console.log("Fetching materiales from:",n);let s=await fetch(n,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(o)}});if(!s.ok){let e=await s.text();throw console.error("Error HTTP: ".concat(s.status," - ").concat(e)),Error("Error HTTP: ".concat(s.status))}let i=await s.json();return console.log("API Response:",i),{data:i.data.map(e=>({id:e.id,nombre:e.nombre,estado:e.estado,fecha_creacion:e.fecha_creacion})),meta:i.meta}}catch(e){return console.error("Error al obtener materiales:",e),{data:[],meta:{current_page:1,from:0,last_page:1,links:[],path:"",per_page:10,to:0,total:0}}}}static async create(e,a){try{if(!e)throw Error("configuracionId es requerido");if(!a||!a.nombre)throw Error("El nombre del material es requerido");let r=(0,t.e9)(),o=(0,t.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",n="".concat(r,"/api/materiales/store/").concat(e);console.log("Creando material:",{url:n,material:a});let s={nombre:a.nombre.trim(),estado:"boolean"==typeof a.estado?+!!a.estado:+("Activo"===a.estado)},i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify(s)});if(!i.ok){let e=await i.json();throw Error(e.message||"Error al crear material: ".concat(i.statusText))}let c=await i.json();if(!c.data)throw Error("La respuesta del servidor no tiene el formato esperado");return{id:c.data.id,nombre:c.data.nombre,estado:c.data.estado,fecha_creacion:c.data.fecha_creacion}}catch(e){throw console.error("Error al crear material:",e),e}}static async update(e,a,r){try{let e=(0,t.e9)(),o=(0,t.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",n="".concat(e,"/api/materiales/update/").concat(a);console.log("Actualizando material:",{url:n,material:r});let s=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({nombre:r.nombre,estado:+("Activo"===r.estado)})});if(!s.ok){let e=await s.json();throw Error(e.message||"Error al actualizar material: ".concat(s.statusText))}let i=await s.json();return{id:i.data.id,nombre:i.data.nombre,estado:i.data.estado,fecha_creacion:i.data.fecha_creacion}}catch(e){throw console.error("Error al actualizar material:",e),e}}static async toggleEstado(e,a){try{let e=(0,t.e9)(),r=(0,t.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",o="".concat(e,"/api/materiales/destroy/").concat(a),n=await fetch(o,{method:"DELETE",headers:{Accept:"application/json",Authorization:"Bearer ".concat(r)}});if(!n.ok){let e=await n.json();throw Error(e.message||"Error al cambiar estado del material: ".concat(n.statusText))}let s=await n.json();return{id:s.data.id,nombre:s.data.nombre,estado:s.data.estado,fecha_creacion:s.data.fecha_creacion}}catch(e){throw console.error("Error al cambiar estado del material:",e),e}}static async delete(e,a){try{let r=(0,t.e9)(),o=(0,t.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",n="".concat(r,"/api/materiales/").concat(e,"/").concat(a),s=await fetch(n,{method:"DELETE",headers:{Accept:"application/json",Authorization:"Bearer ".concat(o)}});if(!s.ok){let e=await s.json();throw Error(e.message||"Error al eliminar material: ".concat(s.statusText))}return!0}catch(e){return console.error("Error al eliminar material:",e),!1}}}},4229:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(9946).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5235:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>d});var t=r(5155),o=r(2115),n=r(5695),s=r(7550),i=r(4229),c=r(1276),l=r(924);function d(){let e=(0,n.useRouter)(),a=(0,n.useParams)(),r=(0,n.useSearchParams)(),d=Number(a.id),m=r.get("empresaId"),u=r.get("configuracionId"),h=r.get("nombre"),p=r.get("estado"),f=r.get("fecha_creacion"),[b,g]=(0,o.useState)({nombre:h||"",estado:"1"===p,fecha_creacion:f||""}),[y,w]=(0,o.useState)({nombre:""}),[x,E]=(0,o.useState)(!1),[A,N]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if(!m||!u||!d||isNaN(d)){console.error("Faltan par\xe1metros requeridos:",{empresaId:m,configuracionId:u,id:d}),e.push("/empresas");return}if(!(0,l.c4)()){console.error("No hay token de autenticaci\xf3n"),e.push("/login");return}E(!1)},[d,m,u,e]);let j=async a=>{if(a.preventDefault(),!b.nombre.trim()){w({nombre:"El nombre del material es requerido"});return}try{N(!0),await c.V.update(Number(u),d,{nombre:b.nombre.trim(),estado:b.estado,fecha_creacion:b.fecha_creacion});let a=new URLSearchParams;m&&a.append("empresaId",m),u&&a.append("configuracionId",u),e.push("/materiales?".concat(a.toString()))}catch(e){console.error("Error al actualizar el material:",e),e instanceof Error&&"NOMBRE_DUPLICADO"===e.message?w({nombre:"El nombre del material ya existe. Por favor, utilice otro nombre."}):w({nombre:"Error al actualizar el material. Por favor, intente nuevamente."}),N(!1)}};return x?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-[#f4f6fb]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-[#303e65] border-t-[#f5d433] rounded-full animate-spin mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Cargando informaci\xf3n..."})]})}):(0,t.jsx)("div",{className:"bg-[#f4f6fb] min-h-screen",children:(0,t.jsxs)("div",{className:"pl-8 pr-6 py-6 max-w-[1200px]",children:[(0,t.jsxs)("button",{onClick:()=>{let a=new URLSearchParams;m&&a.append("empresaId",m),u&&a.append("configuracionId",u),e.push("/materiales?".concat(a.toString()))},className:"inline-flex items-center text-[#303e65] mb-6",children:[(0,t.jsx)(s.A,{className:"h-4 w-4 mr-2"}),"Regresar"]}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Editar registro"}),(0,t.jsx)("p",{className:"text-gray-600 mb-8",children:"Edita el nombre del material seleccionado."}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-8 shadow-sm max-w-[800px] mx-auto",children:(0,t.jsxs)("form",{onSubmit:j,children:[(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"text",id:"nombre",name:"nombre",placeholder:"Nombre Del Material",value:b.nombre,onChange:e=>{g({...b,nombre:e.target.value}),w({nombre:""})},className:"w-full h-12 px-4 bg-[#f4f6fb] rounded-md border-0 focus:ring-2 focus:ring-[#303e65] ".concat(y.nombre?"ring-2 ring-red-500":"")}),y.nombre&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:y.nombre})]})}),(0,t.jsx)("div",{className:"flex justify-end mt-8",children:(0,t.jsx)("button",{type:"submit",disabled:A,className:"flex items-center justify-center bg-[#f5d433] text-[#303e65] font-medium px-6 py-2.5 rounded-full hover:bg-[#f0ca20] transition-colors disabled:opacity-70",children:A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-[#303e65] border-t-transparent rounded-full animate-spin mr-2"}),"Guardando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.A,{className:"h-5 w-5 mr-2"}),"Guardar"]})})})]})})]})})}},5695:(e,a,r)=>{"use strict";var t=r(8999);r.o(t,"useParams")&&r.d(a,{useParams:function(){return t.useParams}}),r.o(t,"usePathname")&&r.d(a,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(a,{useSearchParams:function(){return t.useSearchParams}})},7550:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9946:(e,a,r)=>{"use strict";r.d(a,{A:()=>c});var t=r(2115);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return a.filter((e,a,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===a).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)((e,a)=>{let{color:r="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:l="",children:d,iconNode:m,...u}=e;return(0,t.createElement)("svg",{ref:a,...s,width:o,height:o,stroke:r,strokeWidth:c?24*Number(i)/Number(o):i,className:n("lucide",l),...u},[...m.map(e=>{let[a,r]=e;return(0,t.createElement)(a,r)}),...Array.isArray(d)?d:[d]])}),c=(e,a)=>{let r=(0,t.forwardRef)((r,s)=>{let{className:c,...l}=r;return(0,t.createElement)(i,{ref:s,iconNode:a,className:n("lucide-".concat(o(e)),c),...l})});return r.displayName="".concat(e),r}}},e=>{var a=a=>e(e.s=a);e.O(0,[8441,1684,7358],()=>a(1096)),_N_E=e.O()}]);