(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6269],{924:(e,a,t)=>{"use strict";t.d(a,{c4:()=>c,e9:()=>n,nC:()=>i});var r=t(9509);let o=()=>"https://cidson.api.production.com",n=()=>o().replace(/\/$/,"");function c(){{let e=localStorage.getItem("auth_token");if(e)return e;let a=sessionStorage.getItem("auth_token");if(a)return a}return null}let i={BASE_URL:r.env.NEXT_PUBLIC_API_URL||"https://cidson.int.qaenv.dev",ENDPOINTS:{LOGIN:"/api/login",EMPRESAS:"/api/empresas",ACTIVIDADES:"/api/actividades",ZONAS:"/api/zonas",AREAS:"/api/areas",METODOS:"/api/metodos",MATERIALES:"/api/materiales",MOTIVOS:"/api/motivos",CHECKLISTS:"/api/checklists"}}},3481:(e,a,t)=>{Promise.resolve().then(t.bind(t,7588))},4229:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(9946).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5620:(e,a,t)=>{"use strict";t.d(a,{z:()=>o});var r=t(924);class o{static async getAll(e){try{let a="".concat(r.nC.BASE_URL).concat(r.nC.ENDPOINTS.EMPRESAS);if(e){let t=new URLSearchParams;e.nombre&&t.append("nombre",e.nombre),void 0!==e.estado&&t.append("estado",e.estado.toString()),e.fecha_inicio&&t.append("fecha_inicio",e.fecha_inicio),e.fecha_fin&&t.append("fecha_fin",e.fecha_fin),e.page&&t.append("page",e.page.toString());let r=t.toString();r&&(a+="?".concat(r))}let t=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",o=await fetch(a,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)}});if(!o.ok)throw Error("Error al obtener empresas: ".concat(o.statusText));let n=await o.json();return console.log("Respuesta de la API (getAll):",n),{empresas:n.data.map(e=>({id:e.id,nombre:e.nombre,razonSocial:e.razon_social,fechaRegistro:new Date().toLocaleDateString(),fecha_creacion:e.fecha_creacion,estado:e.estado?"Activo":"Inactivo",configuracion_id:e.configuracion_id})),pagination:n.meta}}catch(e){return console.error("Error al obtener empresas:",e),{empresas:[],pagination:{current_page:1,from:0,last_page:1,links:[],path:"",per_page:10,to:0,total:0}}}}static async create(e){try{let a="".concat(r.nC.BASE_URL).concat(r.nC.ENDPOINTS.EMPRESAS),t=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",o={nombre:e.nombre,razon_social:e.razon_social},n=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(o)});if(!n.ok){let e=await n.json();throw Error(e.message||"Error al crear empresa: ".concat(n.statusText))}let c=await n.json();return console.log("Respuesta de la API (create):",c),{id:c.data.id,nombre:c.data.nombre,razonSocial:c.data.razon_social,fechaRegistro:new Date().toLocaleDateString(),fecha_creacion:c.data.fecha_creacion,estado:c.data.estado?"Activo":"Inactivo",configuracion_id:c.data.configuracion_id}}catch(e){throw console.error("Error al crear empresa:",e),e}}static async getById(e){try{let a="".concat(r.nC.BASE_URL).concat(r.nC.ENDPOINTS.EMPRESAS,"/").concat(e),t=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",o=await fetch(a,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)}});if(!o.ok){if(404===o.status)return;throw Error("Error al obtener empresa: ".concat(o.statusText))}let n=await o.json();return console.log("Respuesta de la API (getById):",n),{id:n.data.id,nombre:n.data.nombre,razonSocial:n.data.razon_social,fechaRegistro:new Date().toLocaleDateString(),fecha_creacion:n.data.fecha_creacion,estado:n.data.estado?"Activo":"Inactivo",configuracion_id:n.data.configuracion_id}}catch(e){console.error("Error al obtener empresa por ID:",e);return}}static async update(e,a){try{let t="".concat(r.nC.BASE_URL).concat(r.nC.ENDPOINTS.EMPRESAS,"/").concat(e),o=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",n={nombre:a.nombre,razon_social:a.razon_social},c=await fetch(t,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify(n)});if(!c.ok){if(404===c.status)return;let e=await c.json();if(422===c.status&&e.errors){let a=Error(e.message||"Error de validaci\xf3n");throw a.validationErrors=e.errors,a}throw Error(e.message||"Error al actualizar empresa: ".concat(c.statusText))}let i=await c.json();return console.log("Respuesta de la API (update):",i),{id:i.data.id,nombre:i.data.nombre,razonSocial:i.data.razon_social,fechaRegistro:new Date().toLocaleDateString(),fecha_creacion:i.data.fecha_creacion,estado:i.data.estado?"Activo":"Inactivo",configuracion_id:i.data.configuracion_id}}catch(e){throw console.error("Error al actualizar empresa:",e),e}}static async toggleActive(e){try{let a="".concat(r.nC.BASE_URL).concat(r.nC.ENDPOINTS.EMPRESAS,"/").concat(e),t=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",o=await fetch(a,{method:"DELETE",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)}});if(!o.ok){if(404===o.status)return;throw Error("Error al cambiar estado de empresa: ".concat(o.statusText))}let n=await o.json();return console.log("Respuesta de la API (toggleActive):",n),{id:n.data.id,nombre:n.data.nombre,razonSocial:n.data.razon_social,fechaRegistro:new Date().toLocaleDateString(),fecha_creacion:n.data.fecha_creacion,estado:n.data.estado?"Activo":"Inactivo",configuracion_id:n.data.configuracion_id}}catch(e){throw console.error("Error al cambiar estado de empresa:",e),e}}}},5695:(e,a,t)=>{"use strict";var r=t(8999);t.o(r,"useParams")&&t.d(a,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},7550:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7588:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>u});var r=t(5155),o=t(2115),n=t(5695),c=t(7550),i=t(4229),s=t(6874),l=t.n(s),d=t(5620);function u(){let e=(0,n.useRouter)(),[a,t]=(0,o.useState)(!1),[s,u]=(0,o.useState)(null),m=new Date().toISOString().split("T")[0],[h,p]=(0,o.useState)({nombre:"",razonSocial:"",fechaRegistro:m}),[f,g]=(0,o.useState)({nombre:"",razonSocial:""}),b=()=>{let e=!0,a={nombre:"",razonSocial:""};return h.nombre.trim()||(a.nombre="El nombre de la empresa es requerido",e=!1),h.razonSocial.trim()||(a.razonSocial="La raz\xf3n social es requerida",e=!1),g(a),e},S=e=>{let{name:a,value:t}=e.target;p({...h,[a]:t}),f[a]&&g({...f,[a]:""})},E=async a=>{if(a.preventDefault(),b()){t(!0),u(null);try{let a={nombre:h.nombre,razon_social:h.razonSocial};await d.z.create(a),e.push("/empresas")}catch(e){console.error("Error al guardar la empresa:",e),u(e instanceof Error?e.message:"Error al guardar la empresa. Por favor, intente nuevamente.")}finally{t(!1)}}};return(0,r.jsx)("div",{className:"bg-[#f4f6fb] min-h-screen",children:(0,r.jsxs)("div",{className:"pl-8 pr-6 py-6 max-w-[1200px]",children:[(0,r.jsxs)(l(),{href:"/empresas",className:"inline-flex items-center text-[#303e65] mb-6",children:[(0,r.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Regresar"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Nuevo registro"}),(0,r.jsx)("p",{className:"text-gray-600 mb-8",children:"Crea y registra una nueva empresa."}),(0,r.jsx)("div",{className:"bg-white rounded-xl p-8 shadow-sm max-w-[800px] mx-auto",children:(0,r.jsxs)("form",{onSubmit:E,children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",id:"nombre",name:"nombre",placeholder:"Nombre De La Empresa",value:h.nombre,onChange:S,className:"w-full h-12 px-4 bg-[#f4f6fb] rounded-md border-0 focus:ring-2 focus:ring-[#303e65] ".concat(f.nombre?"ring-2 ring-red-500":""),disabled:a}),f.nombre&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.nombre})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",id:"razonSocial",name:"razonSocial",placeholder:"Raz\xf3n Social",value:h.razonSocial,onChange:S,className:"w-full h-12 px-4 bg-[#f4f6fb] rounded-md border-0 focus:ring-2 focus:ring-[#303e65] ".concat(f.razonSocial?"ring-2 ring-red-500":""),disabled:a}),f.razonSocial&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.razonSocial})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Fecha De Registro"}),(0,r.jsx)("div",{className:"w-full h-12 px-4 bg-[#f4f6fb] rounded-md border-0 flex items-center text-gray-700",children:new Date().toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})})]}),s&&(0,r.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-sm",children:s})]}),(0,r.jsx)("div",{className:"flex justify-end mt-8",children:(0,r.jsxs)("button",{type:"submit",className:"flex items-center justify-center bg-[#f5d433] text-[#303e65] font-medium px-6 py-2.5 rounded-full hover:bg-[#f0ca20] transition-colors disabled:opacity-70",disabled:a,children:[(0,r.jsx)(i.A,{className:"h-5 w-5 mr-2"}),a?"Guardando...":"Guardar"]})})]})})]})})}},9946:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});var r=t(2115);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter((e,a,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===a).join(" ").trim()};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,a)=>{let{color:t="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:l="",children:d,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:a,...c,width:o,height:o,stroke:t,strokeWidth:s?24*Number(i)/Number(o):i,className:n("lucide",l),...m},[...u.map(e=>{let[a,t]=e;return(0,r.createElement)(a,t)}),...Array.isArray(d)?d:[d]])}),s=(e,a)=>{let t=(0,r.forwardRef)((t,c)=>{let{className:s,...l}=t;return(0,r.createElement)(i,{ref:c,iconNode:a,className:n("lucide-".concat(o(e)),s),...l})});return t.displayName="".concat(e),t}}},e=>{var a=a=>e(e.s=a);e.O(0,[6874,8441,1684,7358],()=>a(3481)),_N_E=e.O()}]);