(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1930],{924:(e,a,t)=>{"use strict";t.d(a,{c4:()=>n,e9:()=>c,nC:()=>i});var r=t(9509);let o=()=>"https://cidson.api.production.com",c=()=>o().replace(/\/$/,"");function n(){{let e=localStorage.getItem("auth_token");if(e)return e;let a=sessionStorage.getItem("auth_token");if(a)return a}return null}let i={BASE_URL:r.env.NEXT_PUBLIC_API_URL||"https://cidson.int.qaenv.dev",ENDPOINTS:{LOGIN:"/api/login",EMPRESAS:"/api/empresas",ACTIVIDADES:"/api/actividades",ZONAS:"/api/zonas",AREAS:"/api/areas",METODOS:"/api/metodos",MATERIALES:"/api/materiales",MOTIVOS:"/api/motivos",CHECKLISTS:"/api/checklists"}}},1228:(e,a,t)=>{"use strict";t.d(a,{h:()=>o});var r=t(924);class o{static async getAll(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let t="".concat(r.nC.BASE_URL,"/api/actividades/").concat(e),o=new URLSearchParams;a.nombre&&o.append("nombre",a.nombre),void 0!==a.estado&&o.append("estado",a.estado.toString()),a.page&&o.append("page",a.page.toString());let c=o.toString();c&&(t+="?".concat(c));let n=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",i=await fetch(t,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(n)}});if(!i.ok){let e=await i.text();try{let a=JSON.parse(e);if(a.message)throw Error(a.message)}catch(e){}throw Error("Error al obtener actividades: ".concat(i.status," - ").concat(e))}return await i.json()}catch(e){throw console.error("Error en ActividadService.getAll:",e),e}}static async getById(e,a){try{let a=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",t=await fetch("".concat(r.nC.BASE_URL,"/api/actividades/detalle/").concat(e),{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(a)}});if(!t.ok){let e=await t.text();try{let a=JSON.parse(e);if(a.message)throw Error(a.message)}catch(e){}throw Error("Error al obtener actividad: ".concat(t.status," - ").concat(e))}return(await t.json()).data}catch(e){throw console.error("Error en ActividadService.getById:",e),e}}static async create(e,a){try{let t=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",o=await fetch("".concat(r.nC.BASE_URL,"/api/actividades/store/").concat(e),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({nombre:a})});if(!o.ok){let e=await o.text();try{let a=JSON.parse(e);if(a.message){if(a.message.includes("already exists"))throw Error("NOMBRE_DUPLICADO");throw Error(a.message)}}catch(e){}throw Error("Error al crear actividad: ".concat(o.status," - ").concat(e))}return(await o.json()).data}catch(e){throw console.error("Error en ActividadService.create:",e),e}}static async update(e,a){try{let t=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",o=await fetch("".concat(r.nC.BASE_URL,"/api/actividades/update/").concat(e),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(a)});if(!o.ok){let e=await o.text();try{let a=JSON.parse(e);if(a.message){if(a.message.includes("already exists"))throw Error("NOMBRE_DUPLICADO");throw Error(a.message)}}catch(e){}throw Error("Error al actualizar actividad: ".concat(o.status," - ").concat(e))}return(await o.json()).data}catch(e){throw console.error("Error en ActividadService.update:",e),e}}static async toggleEstado(e){try{let a=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",t=await fetch("".concat(r.nC.BASE_URL,"/api/actividades/destroy/").concat(e),{method:"DELETE",headers:{Accept:"application/json",Authorization:"Bearer ".concat(a)}});if(!t.ok){let e=await t.text();try{let a=JSON.parse(e);if(a.message)throw Error(a.message)}catch(e){}throw Error("Error al cambiar estado de actividad: ".concat(t.status," - ").concat(e))}return(await t.json()).data}catch(e){throw console.error("Error en ActividadService.toggleEstado:",e),e}}static async delete(e){try{let a=(0,r.c4)()||"yBPONqL0SH66XBKyfXu2ouwayDl7qaCn05ODKAioebfbd8ad",t=await fetch("".concat(r.nC.BASE_URL,"/api/actividades/").concat(e),{method:"DELETE",headers:{Accept:"application/json",Authorization:"Bearer ".concat(a)}});if(!t.ok){let e=await t.text();try{let a=JSON.parse(e);if(a.message)throw Error(a.message)}catch(e){}throw Error("Error al eliminar actividad: ".concat(t.status," - ").concat(e))}return!0}catch(e){throw console.error("Error en ActividadService.delete:",e),e}}}},3065:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>u});var r=t(5155),o=t(2115),c=t(5695),n=t(7550),i=t(4229),s=t(6874),d=t.n(s),l=t(1228);function u(){let e=(0,c.useRouter)(),a=(0,c.useParams)(),t=(0,c.useSearchParams)(),s=Number(a.id),u=t.get("empresaId"),m=t.get("configuracionId"),h=t.get("returnTo"),p=t.get("nombre"),f=t.get("estado"),g=t.get("fecha_creacion"),[v,y]=(0,o.useState)({nombre:p||""}),[b,w]=(0,o.useState)({nombre:""}),[E,S]=(0,o.useState)(!1),[x,A]=(0,o.useState)(!1),[N,j]=(0,o.useState)(p?{id:s,nombre:p,estado:"1"===f,fecha_creacion:g}:null),[O,B]=(0,o.useState)(null);(0,o.useEffect)(()=>{p?S(!1):(w({nombre:"No se encontr\xf3 la informaci\xf3n de la actividad. Regresando a la lista..."}),setTimeout(()=>{L()},2e3))},[p]);let L=()=>{let a=new URLSearchParams;if(u&&a.append("empresaId",u),m?a.append("configuracionId",m):N&&N.configuracion_id&&a.append("configuracionId",N.configuracion_id.toString()),h)e.push(h);else{let t=a.toString(),r="/actividades".concat(t?"?".concat(t):"");console.log("Redirigiendo a: ".concat(r)),e.push(r)}},P=()=>{let e=!0,a={nombre:""};return v.nombre.trim()||(a.nombre="El nombre de la actividad es requerido",e=!1),w(a),e},C=async e=>{if(e.preventDefault(),P())try{A(!0),console.log("Actualizando actividad con ID ".concat(s,", nombre: ").concat(v.nombre));let e=await l.h.update(s,{nombre:v.nombre.trim()});if(e)console.log("Actividad actualizada exitosamente:",e),L();else throw Error("No se pudo actualizar la actividad")}catch(e){console.error("Error al actualizar la actividad:",e),w({nombre:"Ocurri\xf3 un error al actualizar la actividad. Por favor, intente nuevamente."}),A(!1)}};return E?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-[#f4f6fb]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-[#303e65] border-t-[#f5d433] rounded-full animate-spin mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Cargando informaci\xf3n..."})]})}):(0,r.jsx)("div",{className:"bg-[#f4f6fb] min-h-screen",children:(0,r.jsxs)("div",{className:"pl-8 pr-6 py-6 max-w-[1200px]",children:[(0,r.jsxs)(d(),{href:(()=>{if(h)return h;let e=new URLSearchParams;u&&e.append("empresaId",u),m&&e.append("configuracionId",m);let a=e.toString();return"/actividades".concat(a?"?".concat(a):"")})(),className:"inline-flex items-center text-[#303e65] mb-6",children:[(0,r.jsx)(n.A,{className:"h-4 w-4 mr-2"}),"Regresar"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Editar registro"}),(0,r.jsx)("p",{className:"text-gray-600 mb-8",children:"Crea y registra nuevas actividades."}),(0,r.jsx)("div",{className:"bg-white rounded-xl p-8 shadow-sm max-w-[800px] mx-auto",children:(0,r.jsxs)("form",{onSubmit:C,children:[(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",id:"nombre",name:"nombre",placeholder:"Nombre De La Actividad",value:v.nombre,onChange:e=>{let{name:a,value:t}=e.target;y({...v,[a]:t}),b[a]&&w({...b,[a]:""})},className:"w-full h-12 px-4 bg-[#f4f6fb] rounded-md border-0 focus:ring-2 focus:ring-[#303e65] ".concat(b.nombre?"ring-2 ring-red-500":"")}),b.nombre&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:b.nombre})]})}),(0,r.jsx)("div",{className:"flex justify-end mt-8",children:(0,r.jsx)("button",{type:"submit",disabled:x,className:"flex items-center justify-center bg-[#f5d433] text-[#303e65] font-medium px-6 py-2.5 rounded-full hover:bg-[#f0ca20] transition-colors disabled:opacity-70",children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-[#303e65] border-t-transparent rounded-full animate-spin mr-2"}),"Guardando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{className:"h-5 w-5 mr-2"}),"Guardar"]})})})]})})]})})}},4229:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(9946).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5695:(e,a,t)=>{"use strict";var r=t(8999);t.o(r,"useParams")&&t.d(a,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},6600:(e,a,t)=>{Promise.resolve().then(t.bind(t,3065))},7550:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9946:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});var r=t(2115);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),c=function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter((e,a,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===a).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,a)=>{let{color:t="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:d="",children:l,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:a,...n,width:o,height:o,stroke:t,strokeWidth:s?24*Number(i)/Number(o):i,className:c("lucide",d),...m},[...u.map(e=>{let[a,t]=e;return(0,r.createElement)(a,t)}),...Array.isArray(l)?l:[l]])}),s=(e,a)=>{let t=(0,r.forwardRef)((t,n)=>{let{className:s,...d}=t;return(0,r.createElement)(i,{ref:n,iconNode:a,className:c("lucide-".concat(o(e)),s),...d})});return t.displayName="".concat(e),t}}},e=>{var a=a=>e(e.s=a);e.O(0,[6874,8441,1684,7358],()=>a(6600)),_N_E=e.O()}]);